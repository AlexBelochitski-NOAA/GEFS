#######################################################
# This file defines the various input varibles for the
# GEFS model run
#######################################################
 
export RUN_ENVIR=${RUN_ENVIR:-dev}
export envir=${envir:-dev}
export SENDDBN=${SENDDBN:-%SENDDBN:NO%}
export SENDDBN_NTC=${SENDDBN_NTC:-%SENDDBN_NTC:NO%}

export KEEPDATA=NO
export KEEPDATA=YES
export SENDCOM=YES
export SENDECF=NO

export PARAFLAG=${PARAFLAG:-YES}
export SENDECF=${SENDECF:-NO}
export SENDCOM=${SENDCOM:-YES}
export KEEPDATA=${KEEPDATA:-%KEEPDATA:NO%}

export COMROOT=$baseoutput/com
export GESROOT=$baseoutput/nwges
export DATAROOT=$baseoutput/tmpnwprd
export DCOMROOT=${DCOMROOT:-/dcom}

mkdir -p  $COMROOT/logs/jlogfiles

export archsyndir=/com/arch/prod/syndat
export GESROOTp1=/nwges
export DBNROOT=

export NWROOT=/nwprod2
export NWROOTprod=/nwprod2
export NWROOTp1=/nwprod
export PCOMROOT=${PCOMROOT:-/pcom2/${envir}}

HOMEDIR=/ensemble/save/emc.enspara/RFC
HOMEDIR=/nwprod2
export gefsmachine=${gefsmachine:-dell}

#  export HOMEgefs=$HOMEDIR/gefs.v11.1.1
  export HOMEgefs=$basesource/nwdev

  #export HOMEgsm=$HOMEDIR/gsm.v12.1.3
  export HOMEgsm=/gpfs/dell2/emc/retros/noscrub/Xianwu.Xue/z_GSM/GEFS_gsm      
  #export HOMEpost=$HOMEDIR/ncep_post.v5.1.2
  export HOMEpost=/gpfs/dell2/emc/retros/noscrub/Xianwu.Xue/z_GSM/GEFS_ncep_post      
# export HOMEenkf=$HOMEDIR/enkf.v2.0.3
# export HOMEenkf=/nwprod/enkf.v2.0.3
  export HOMEenkf=/gpfs/dell2/emc/retros/noscrub/Xianwu.Xue/z_GSM/GEFS_ENKF
  export HOMEtrak=$HOMEDIR/ens_tracker.v1.1.8

# export APRUN=$gefsmpexec

# This section is optional, using path to define utility files
# export UTILROOT=/gpfs/dell1/nco/ops/nwprod/prod_util.v1.0.0  for dell
# export GRIBROOT=/gpfs/dell1/nco/ops/nwprod/grib_util.v1.0.1  for dell
# export EXECutil=$UTILROOT/exec
# export USHutil=$UTILROOT/ush
# export EXECgrib=$GRIBROOT/exec

  . /usrx/local/prod/lmod/lmod/init/ksh
  module use /gpfs/dell1/nco/ops/nwprod/modulefiles
  module load prod_util/1.1.0
  module load grib_util/1.1.0
  module load util_shared/1.1.0

# module load compiler_prod/ips/18.0.1/graphics/2.0.0
# module load dev/graphics/2.0.0
  
# module load NetCDF/4.5.0
# module load HDF5-serial/1.10.1
  module load impi/18.0.1
  module load CFP/2.0.1
  export USE_CFP=YES
  export PATH=$PATH:.

# module load ics
  module load lsf/10.1

# module load prod_util
# module load /usrx/local/nceplibs/dev/lib/grib_util/v1.1.0
# module load /usrx/local/nceplibs/dev/lib/util_shared/v1.1.0

#
  export NDATE=${NDATE:-$USHutil/ndate}

  export WGRIB=${WGRIB:-$EXECgrib/wgrib}
  export GRBINDEX=${GRBINDEX:-$EXECgrib/grbindex}
  export COPYGB=${COPYGB:-$EXECgrib/copygb}
  export WGRIB2=${WGRIB2:-$EXECgrib/wgrib2}
  export GRB2INDEX=${GRB2INDEX:-$EXECgrib/grb2index}
  export COPYGB2=${COPYGB2:-$EXECgrib/copygb2}
  export CNVGRIB=${CNVGRIB:-$EXECgrib/cnvgrib21_gfs}
  export CNVGRIB21_GFS=${CNVGRIB21_GFS:-$EXECgrib/cnvgrib21_gfs}
  export CNVGRIB=$CNVGRIB21_GFS

  export NET=gens
# export RUN=$RUN
# export RUNMEM=$RUNMEM

# Temperay setting for testing some special jobs, comment them out for real time dev test
# export COMINGEST=/ensemble/noscrub/Yan.Luo/com-ingest-prod  #temporary testing of CQPF job
# export COMIN=/ensemble/noscrub/emc.enspara/xz/T574L64SL/EK0 #temporary testing of CQPF job
 
# export COMINgfs=/com2/gfs/prod/gfs.$PDY
# export COMINenkf=/com2/gfs/prod/enkf.
#
# 
# Define COMINgfs and COMINenkf and alike for the enkf_track job 
  export GFSbase=/gpfs/dell1/nco/ops/com/gfs/para
  export COMINenkf=${GFSbase}/enkfgdas.
  export COMINgfs=${GFSbase}/gfs.${PDY}/${cyc}

  if [[ ${jobscript} = JGEFS_ENKF_TRACK ]] ; then
d6ahead_ymdh=${PDY}${cyc}
d_hour_ymdh=` $NDATE -6 ${PDY}${cyc}`
d6ago_ymdh=` $NDATE -12 ${PDY}${cyc}`
export d6ahead_ymd=`echo $d6ahead_ymdh|cut -c1-8`
export d6ahead_hh=`echo $d6ahead_ymdh|cut -c9-10`
export d6ago_ymd=`echo $d6ago_ymdh|cut -c1-8`
export d6ago_hh=`echo $d6ago_ymdh|cut -c9-10`
export d_hour_ymd=`echo $d_hour_ymdh|cut -c1-8`
export d_hour_hh=`echo $d_hour_ymdh|cut -c9-10`

  export COMINgfs=${GFSbase}/gfs.${d_hour_ymd}/${d_hour_hh}
  export COMINgfs6ago=${GFSbase}/gfs.${d6ago_ymd}/${d6ago_hh}
  export COMINgfs6ahead=${GFSbase}/gfs.${d6ahead_ymd}/${d6ahead_hh}
  fi 
