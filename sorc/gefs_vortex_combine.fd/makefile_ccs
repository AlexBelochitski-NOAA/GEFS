
SHELL = /bin/sh

SRCS=	gefs_vortex_combine.f90

OBJS=	gefs_vortex_combine.o

INCMODS=/nwprod/lib/incmod/sigio_4

CF =    xlf_r
FC =    ncepxlf
LDFLAGS =
#LIBS  = -L/nwprod/lib -lsp_d -lw3_d -lbufr_d_64
LIBS  = -L/nwprod/lib -lsp_d -lw3_d -lbufr_d_64 -L . -lsigio_4
#LIBS  = -L/nwprod/lib -lsp_d -lw3_d -lbufr_d_64 -lsigio_4

CMD =   gefs_vortex_combine
#PROFLIB =   -lessl    -lprof
PROFLIB =   -lessl

#FFLAGS= -qsmp=noauto -p -O -NS10000 -qintsize=4 -qrealsize=8 -qmaxmem=-1 -qinitauto -qsource -qflttrap
FFLAGS= -qsmp=noauto -p -O -NS10000 -qintsize=4 -qrealsize=8 -qmaxmem=-1 -qinitauto -qsource -qflttrap -I $(INCMODS)
LDFLAGS=-l essl

all:  $(CMD)

$(CMD): $(OBJS)
	$(CF) $(FFLAGS) $(LDFLAGS) -o $(@) $(OBJS) $(LIBS)

# Make the profiled version of the command and call it a.out.prof
#
$(CMD).prof:    $(OBJS)
	$(CF) $(LDFLAGS) -o $(@) $(OBJS) $(PROFLIB) $(LIBS)

clean:
	-rm -f $(OBJS)

clobber:        clean
	-rm -f $(CMD) $(CMD).prof

void:   clobber
	-rm -f $(SRCS) makefile
